#include "main.h"
using namespace std;

ManagerFile::ManagerFile(SOCKET socketC)
	: OperateSocket(socketC){
}

int ManagerFile::sendFile(LPSTR filename) {
	HANDLE file;
	HANDLE bFile;
	file = CreateFileA(
		filename,
		GENERIC_READ | GENERIC_WRITE,
		FILE_SHARE_READ,
		NULL,
		OPEN_EXISTING,
		FILE_ATTRIBUTE_NORMAL,
		NULL);
	if (file == INVALID_HANDLE_VALUE)
		return -1;
	DWORD file_size = GetFileSize(file, NULL);
	LPVOID buf_file;
	LPSTR data;
	buf_file = malloc(file_size + 1);
	DWORD bytesRead;
	ReadFile(file, buf_file, file_size, &bytesRead, NULL);
	data = (LPSTR)buf_file;
	OperateSocket::send_func(&data[0], file_size);
	return 0;
}

